# Grocery Calc program (GRCAMAIN)
# This particular version is for the newer GII models
#
# rev: 0.75 20180614-0939
#     unknown relation to the next revision
# rev 0.75.1 20210503-16:00
#      conversion from .G1M to text

# Switch files to the last available for a 9750G/G+/GII
# This then allows us to use our own lists
File 6â†µ
# Save my current variables to a list
Prog "GRCPUT"â†µ
StoV-Win 6â†µ
# Now we set the screen up the way we want
Fix 2â†µ
CoordOffâ†µ
GridOffâ†µ
AxesOffâ†µ
LabelOffâ†µ
# Request last-saved totals?
Lbl 2â†µ
ClrTextâ†µ
Clsâ†µ
BG-Noneâ†µ
Text 25,5,"Load saved totals?"â†µ
Prog "GRCYN"â†µ
# If yes, continue
K=79â‡’Goto Lâ†µ
Kâ‰ 29â‡’Goto 2â†µ
# Otherwise, clear the counters we'll need
0â†’A~Zâ†µ
#Reset List counterâ†µ
17â†’Mâ†µ
#Create clean listâ†µ
17â†’Dim List 4â†µ
# Load the Initial Tax % (NZ's GST)â†µ
15â†’Nâ†µ
Goto 1 # skip a bit forwardâ†µ
# Remove vars
Lbl Tâ†µ
Prog "GRCRM"â†µ
# Let's set this upâ†µ
Lbl 1â†µ
0â†’Kâ†µ
Fix 2â†µ
ViewWindow 1,127,0,63,1,0â†µ
Prog "GRCBTN"â†µ
Lbl 0â†µ
If Z=0â†µ
Then (1-(100Ã·(100+N)))â†’Oâ†µ
IfEndâ†µ
If Z=1â†µ
Then NÃ·100â†’Oâ†µ
IfEndâ†µ
Clsâ†µ
# Created from GRCBTNâ†µ
BG-Pict 6â†µ
# What key did we pressâ†µ
Prog "GRCTST"â†µ
Text 1,42,ReP Fâ†µ
# Sum the Real parts of A,B,C,D and E
ReP A+ReP B+ReP C+ReP D+ReP Eâ†’Gâ†µ
# Sum the Imaginary parts of A,B,C,D and E
ImP A+ImP B+ImP C+ImP D+ImP Eâ†’Jâ†µ
Text 49,30,Gâ†µ
Norm â†µ
'Text 1,68,Mâ†µ
Text 49,68,Jâ†µ
Fix 2â†µ
If Z=0â†µ
Then GÃ—Oâ†’Jâ†µ
Text 49,99,"I"â†µ
IfEndâ†µ
If Z=1â†µ
Then GÃ—Oâ†’Jâ†µ
G+Jâ†’Gâ†µ
Fix 2â†µ
Text 49,30,Gâ†µ
Text 49,99,"A"â†µ
IfEndâ†µ
'Alternate isâ†µ
'G+(GÃ—(NÃ·100))â†µ
Fix 3â†µ
Text 41,104,Nâ†µ
Fix 2â†µ
Text 49,108,Jâ†µ
If ReP A>0â†µ
Then Text 9,30,ReP Aâ†µ
Norm â†µ
Text 9,68,ImP Aâ†µ
Fix 2â†µ
IfEndâ†µ
If ReP B>0â†µ
Then Text 17,30,ReP Bâ†µ
Norm â†µ
Text 17,68,ImP Bâ†µ
Fix 2â†µ
IfEndâ†µ
If ReP C>0â†µ
Then Text 25,30,ReP Câ†µ
Norm â†µ
Text 25,68,ImP Câ†µ
Fix 2â†µ
IfEndâ†µ
If ReP D>0â†µ
Then Text 33,30,ReP Dâ†µ
Norm â†µ
Text 33,68,ImP Dâ†µ
Fix 2â†µ
IfEndâ†µ
If ReP E>0â†µ
Then Text 41,30,ReP Eâ†µ
Norm â†µ
Text 41,68,ImP Eâ†µ
Fix 2â†µ
IfEndâ†µ
P>0â‡’Text 1,94,Pâ†µ
Q>0â‡’Text 9,94,Qâ†µ
R>0â‡’Text 17,94,Râ†µ
S>0â‡’Text 25,94,Sâ†µ
T>0â‡’Text 33,94,Tâ†µ
Lbl Kâ†µ
# Main Menuâ†µ
# Cycle until we have suitable keyâ†µ
Getkeyâ†’Kâ†µ
# Category A - Eâ†µ
K=79â‡’Goto Aâ†µ
K=69â‡’Goto Bâ†µ
K=59â‡’Goto Câ†µ
K=49â‡’Goto Dâ†µ
K=39â‡’Goto Eâ†µ
# Undo [DEL]â†µ
K=44â‡’Goto Uâ†µ
# Exit prompt [EXIT]â†µ
K=47â‡’Goto 8â†µ
# temp vars menu [â†’]â†µ
K=25â‡’Goto Pâ†µ
# Function menu [MENU]â†µ
K=48â‡’Goto Xâ†µ
# Snapshot the screen [7]â†µ
K=74â‡’StoPict 5â†µ
# Help menu [F6]â†µ
If K=29â†µ
Then Prog "GRCHELP"â†µ
Goto 0â†µ
IfEndâ†µ
# nothing matched, go around the loop againâ†µ
Kâ‰ 48â‡’Goto Kâ†µ
# Only thing left over: [EXIT]â†µ
Goto Xâ†µ
# Vegesâ†µ
Lbl Aâ†µ
BG-Noneâ†µ
# Pop out to Weight/Count requesterâ†µ
Prog "GRCRQR"â†µ
Kâ†’Lâ†µ
0â†’Uâ†µ
M+1â†’Mâ†µ
Mâ†’List 4[1]â†µ
F+1ð’Šâ†’List 4[M]â†µ
Goto 0â†µ
# Meatâ†µ
Lbl Bâ†µ
BG-Noneâ†µ
# Pop out to Weight/Count requester
Prog "GRCRQR"â†µ
Kâ†’Lâ†µ
0â†’Uâ†µ
M+1â†’Mâ†µ
Mâ†’List 4[1]â†µ
F+2ð’Šâ†’List 4[M]â†µ
Goto 0â†µ
# Miscâ†µ
Lbl Câ†µ
Prog "GRCITEM"â†µ
Kâ†’Lâ†µ
M+1â†’Mâ†µ
Mâ†’List 4[1]â†µ
F+3ð’Šâ†’List 4[M]â†µ
Goto 0â†µ
# Dairy
Lbl Dâ†µ
Prog "GRCITEM"â†µ
Kâ†’Lâ†µ
M+1â†’Mâ†µ
Mâ†’List 4[1]â†µ
F+4ð’Šâ†’List 4[M]â†µ
Goto 0â†µ
# Cleanâ†µ
Lbl Eâ†µ
Prog "GRCITEM"â†µ
Kâ†’Lâ†µ
M+1â†’Mâ†µ
Mâ†’List 4[1]â†µ
F+5ð’Šâ†’List 4[M]â†µ
Goto 0â†µ
# Undo Last Entryâ†µ
Lbl Uâ†µ
L=79â‡’A-Hð’Š-Fâ†’Aâ†µ
L=69â‡’B-Hð’Š-Fâ†’Bâ†µ
L=59â‡’C-Hð’Š-Fâ†’Câ†µ
L=49â‡’D-Hð’Š-Fâ†’Dâ†µ
L=39â‡’E-Hð’Š-Fâ†’Eâ†µ
0â†’K~Lâ†µ
# Empty out the last-used entryâ†µ
0â†’List 4[M]â†µ
# Subtract one off the used countâ†µ
M-1â†’Mâ†µ
Mâ†’List 4[1]â†µ
# Back to main loopâ†µ
Goto 0â†µ
# Temp Val requesterâ†µ
Lbl Pâ†µ
Clsâ†µ
ClrTextâ†µ
If P=0â†µ
Then "P"?â†’Pâ†µ
Goto 0â†µ
Else If Q=0â†µ
Then "Q"?â†’Qâ†µ
Goto 0â†µ
Else If R=0â†µ
Then "R"?â†’Râ†µ
Goto 0â†µ
Else If S=0â†µ
Then "S"?â†’Sâ†µ
Goto 0â†µ
Else If T=0â†µ
Then "T"?â†’Tâ†µ
Else â†µ
BG-Noneâ†µ
Text 9,15,"The temporary slots P-T"â†µ
Text 17,35,"are all full."â†µ
Text 33,14,"You can empty them from"â†µ
Text 41,12,"the Function->Erase menu."â†µ
# Pop up a menu in case we want to erase
Text 58,107,"Erase"â†µ
Text 58,1,"Back"â†µ
Lbl Qâ†µ
Getkeyâ†’Uâ†µ
U=29â‡’Prog "GRCRM"â†µ
Uâ‰ 79â‡’Goto Qâ†µ
IfEndâ†µ
0â†’Uâ†µ
Goto 0â†µ
# Functions menuâ†µ
Lbl Xâ†µ
BG-Noneâ†µ
Clsâ†µ
Text 20,10,"Choose function or Exit"â†µ
Text 58,1,"Back"â†µ
Text 58,19,"Prefs"â†µ
Text 58,42,"Erase"â†µ
Text 58,65,"Store"â†µ
Text 58,90,"Load"â†µ
Text 58,112,"List"â†µ
Lbl Vâ†µ
Getkeyâ†’Kâ†µ
K=79â‡’Goto 1â†µ
If K=69â†µ
Then Prog "GRCPREFS"â†µ
Goto Xâ†µ
IfEndâ†µ
'K=69â‡’Goto 9â†µ
K=59â‡’Goto Tâ†µ
K=49â‡’Goto Sâ†µ
K=39â‡’Goto Lâ†µ
K=29â‡’Prog "GRCLIST"â†µ
Kâ‰ 47â‡’Goto Vâ†µ
'Exit keyâ†µ
Lbl 8â†µ
BG-Noneâ†µ
Clsâ†µ
Text 14,20,"Save current totals"â†µ
Text 22,20,"for next time?"â†µ
Prog "GRCYN"â†µ
K=79â‡’Goto 5â†µ
Kâ‰ 29â‡’Goto 8â†µ
Lbl 4â†µ
0â†’K~Lâ†µ
BG-Noneâ†µ
ClrTextâ†µ
Prog "GRCGET"â†µ
RclV-Win 6â†µ
File 1â†µ
Stopâ†µ
Lbl 5â†µ
Prog "GRCSAVE"â†µ
Goto 4â†µ
Lbl Sâ†µ
Prog "GRCSAVE"â†µ
Goto 0â†µ
Lbl Lâ†µ
Prog "GRCLOAD"â†µ
Goto 0â†µ
EndFilename

